---
name: lalm_bench_simplification
overview: inference/evaluation 2-env 고정 + 메인/사이드 분리로 온보딩/운영 복잡도를 낮춥니다.
status: planning
---

# lalm_bench 단순화 TODO (에픽 단위)

## 범위/원칙(고정)

- 메인(벤치마크) 실행은 `envs/inference`, `envs/evaluation` **2개 환경만** 사용합니다.
- 루트 `pyproject.toml`은 **런타임 실행 의존성**을 가지지 않고(또는 최소화), 개발/도구/패키징만 담당합니다.
- 사이드 프로젝트는 동일 repo 내부에서 `experiments/`(가칭)로 분리하고, 메인 배포/실행 경로에 섞이지 않게 합니다.

## Epic A. 실행 환경 단순화(2-env 고정)

### 목표
- “무엇을 설치해야 실행되는지”를 `envs/*` 두 개로 수렴시켜 온보딩을 단순화합니다.

### 태스크
- [ ] A1. 루트 런타임 의존성 제거/축소(개발/CLI 최소만 유지)
  - **대상**: `pyproject.toml`, `uv.lock`
  - **완료조건**: 루트 `uv sync` 없이도(또는 최소 의존성만으로) `lalm` 실행 경로가 성립합니다.
- [ ] A2. `cli.py` 실행 경로를 2-env 기준으로 명확화
  - **대상**: `cli.py`
  - **완료조건**: inference는 `envs/inference`, evaluation은 `envs/evaluation`만 사용한다는 규칙이 코드/도움말에서 드러납니다.
- [ ] A3. 2-env 간 버전 충돌(예: `transformers` pin) 이유를 문서로 고정
  - **대상**: `README.md` 또는 `docs/`(선택)
  - **완료조건**: “왜 분리해야 하는지”가 한 문단으로 설명됩니다.

## Epic B. 메인/사이드 프로젝트 분리(Repo 내부 분리)

### 목표
- 벤치마크 코어와 실험/검증 코드를 물리적으로 분리해, 목적/책임/의존성 경계를 선명히 합니다.

### 태스크
- [ ] B1. 사이드 디렉토리 루트 결정 및 규약 확정
  - **결정사항**: `experiments/`(권장) 또는 다른 이름
  - **완료조건**: 사이드 코드는 해당 루트 아래로만 위치합니다.
- [ ] B2. 사이드 코드 이동(예: attention, 유사도, 루브릭)
  - **대상**: `visualization.py`, `projects/*`
  - **완료조건**: 메인 `src/` 트리에는 벤치마크 실행에 필요한 코드만 남습니다.
- [ ] B3. 사이드 실행 진입점 표준화(스크립트/CLI 선택)
  - **결정사항**: `uv run python experiments/...` 형태 유지 vs 별도 CLI(`typer`) 추가
  - **완료조건**: 사이드 실행 방법이 최소 1가지 규약으로 통일됩니다.

## Epic C. 경로/임포트/데이터 접근 규약 정리

### 목표
- 이동/분리 이후에도 경로가 깨지지 않도록 “상대경로/루트 탐지/PYTHONPATH” 규칙을 고정합니다.

### 태스크
- [ ] C1. 코드가 참조하는 프로젝트 루트 기준 단일화
  - **대상**: `cli.py`, (필요 시) `src/**`, `experiments/**`
  - **완료조건**: 프로젝트 루트 탐지/경로 결정을 한 방식으로 통일합니다.
- [ ] C2. 산출물/입력 경로 규약 확정
  - **대상**: `outputs/`, `temp/`, `data/`
  - **완료조건**: “입력 데이터/출력 산출물/임시 산출물”이 서로 섞이지 않습니다.

## Epic D. Docker/Compose 단순화(2-env 반영)

### 목표
- Docker는 선택 경로로 유지하되, 루트 런타임 설치에 기대지 않게 정리합니다.

### 태스크
- [ ] D1. `Dockerfile`에서 루트 `uv sync` 의존 제거/최소화
  - **대상**: `Dockerfile`
  - **완료조건**: 컨테이너 빌드가 `envs/inference`, `envs/evaluation` 중심으로 정의됩니다.
- [ ] D2. `docker-compose.yaml`의 개발용 sync/볼륨 정책 재정의
  - **대상**: `docker-compose.yaml`
  - **완료조건**: 개발자 경험(캐시/venv/코드 sync)이 단순한 규칙으로 설명됩니다.

## Epic E. 문서/온보딩 재작성(최소 경로)

### 목표
- “가장 짧은 성공 경로”를 2-env 기준으로 제시합니다.

### 태스크
- [ ] E1. 빠른 시작을 2-env 기준으로 재정리
  - **대상**: `README.md`
  - **완료조건**: 신규 사용자가 따라할 명령이 최소화됩니다(루트 `uv sync` 비필수).
- [ ] E2. 메인 vs 사이드 사용법 분리 서술
  - **대상**: `README.md` 또는 `docs/`
  - **완료조건**: “메인 벤치마크”와 “실험/검증” 섹션이 분리됩니다.

## Epic F. Repo 위생(대용량/산출물/캐시)

### 목표
- 리포지토리에 섞여 들어온 산출물/대용량 파일을 정리해, 코드 중심으로 유지합니다.

### 태스크
- [ ] F1. 산출물/캐시/대용량 파일 목록화 및 처리 방침 결정
  - **대상**: `temp/`, `outputs/`, (대용량 데이터/MP3 등)
  - **완료조건**: “repo에 남길 것/지울 것/외부로 뺄 것” 기준이 문서로 남습니다.
- [ ] F2. `.gitignore` 및 디렉토리 규약 반영
  - **대상**: `.gitignore`(존재 시), 관련 디렉토리 구조
  - **완료조건**: 실험 산출물이 기본적으로 커밋되지 않습니다.